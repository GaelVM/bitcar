<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Control Vehicular</title>
  <meta property="og:type" content="website">
  <meta property="og:title" content="Proyecto control vehicular">
  <meta property="og:description" content="BitCar, es un proyecto para control vehicular.">
  <meta property="og:image" content="https://cdn-icons-png.flaticon.com/512/10794/10794264.png">
  <meta property="og:url" content="https://controlvehicular.vercel.app/">
  <style>
    :root{
      --bg:#0b1020; --panel:#111831; --muted:#8aa0b6; --text:#e6eef7; --brand:#6aa6ff; --ok:#16a34a; --warn:#f59e0b; --bad:#ef4444; --border:#26304a;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial; background:linear-gradient(180deg,#0b1020 0%,#0b1428 100%); color:var(--text)}
    .container{max-width:1100px; margin:0 auto; padding:24px}
    header{display:flex; align-items:center; justify-content:space-between; gap:12px; padding:16px 0}
    .brand{display:flex; align-items:center; gap:12px}
    .logo{width:36px; height:36px; border-radius:10px; background:linear-gradient(135deg,#61a0ff,#8bd3ff); box-shadow:0 6px 24px rgba(106,166,255,.35)}
    h1{font-size:20px; margin:0}
    .card{background:#111831; border:1px solid var(--border); border-radius:16px; padding:18px; box-shadow:0 10px 30px rgba(0,0,0,.25)}
    .grid{display:grid; gap:16px}
    .grid.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
    .grid.cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}
    @media (max-width:900px){.grid.cols-2,.grid.cols-3{grid-template-columns:1fr}}
    .muted{color:var(--muted)}
    .btn{display:inline-flex; align-items:center; justify-content:center; gap:8px; padding:10px 14px; border-radius:12px; border:1px solid var(--border); background:#192243; color:var(--text); cursor:pointer}
    .btn.primary{background:linear-gradient(135deg,#5f95ff,#6fd1ff); color:#091228; border-color:transparent}
    .btn.danger{background:#3a0f19; border-color:#5c1625; color:#ffd7df}
    .btn.gray{background:#121a34}
    .toolbar{display:flex; gap:8px; flex-wrap:wrap}
    input,select{width:100%; padding:10px 12px; border-radius:12px; border:1px solid var(--border); background:#0e1530; color:var(--text)}
    label{display:block; font-size:12px; color:var(--muted); margin-bottom:6px}
    .row{display:grid; grid-template-columns:160px 1fr; align-items:center; gap:12px}
    @media (max-width:760px){.row{grid-template-columns:1fr}} 
    .row + .row{margin-top:10px}
    table{width:100%; border-collapse:collapse; overflow:hidden; border-radius:12px}
    th,td{padding:10px 12px; border-bottom:1px solid var(--border)}
    th{background:#101735; text-align:left; font-weight:600}
    tr:hover td{background:#0d1430}
    .badge{display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px; font-size:12px; border:1px solid var(--border)}
    .badge.ok{background:#062515; color:#b7f7ce; border-color:#1d4d2a}
    .badge.warn{background:#281a05; color:#ffe2aa; border-color:#5f3b0a}
    .badge.bad{background:#2a0c0c; color:#ffc0c0; border-color:#5c1616}
    .section-title{display:flex; align-items:center; justify-content:space-between; margin:6px 0 14px}
    .section-title h2{font-size:16px; margin:0}
    .chip{display:inline-flex; padding:4px 8px; border-radius:999px; background:#0e1738; color:var(--muted); border:1px solid var(--border); font-size:12px}
    .hidden{display:none !important}
    .divider{height:1px; background:var(--border); margin:8px 0 16px}
    .footer{margin-top:18px; color:var(--muted); font-size:12px}

    /* Tablas como tarjetas en móvil */
    @media (max-width:760px){
      table.responsive{display:block; border:0}
      table.responsive thead{display:none}
      table.responsive tbody{display:block; width:100%}
      table.responsive tr{display:block; border:1px solid var(--border); border-radius:12px; margin:10px 0; padding:6px 0}
      table.responsive td{display:block; border:none; padding:8px 12px}
      table.responsive td::before{content:attr(data-th) ": "; font-weight:600; color:var(--muted); display:block; margin-bottom:4px}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo"></div>
        <h1>Control Vehicular</h1>
        <span class="chip" id="appVersion"></span>
      </div>
      <div class="muted" id="whoami"></div>
      <button class="btn gray hidden" id="btnLogout">Salir</button>
    </header>

    <!-- LOGIN VIEW -->
    <section id="viewLogin" class="card">
      <div class="grid cols-2">
        <div>
          <h2>Ingreso</h2>
          <p class="muted">Conductor o Administrador</p>
          <div class="divider"></div>
          <div class="row"><label>Usuario</label><input id="loginUser" autocomplete="username" placeholder="p.ej. admin"></div>
          <div class="row"><label>Contraseña</label><input id="loginPass" type="password" autocomplete="current-password" placeholder="••••••"></div>
          <div class="row"><div></div><button class="btn primary" id="btnLogin">Entrar</button></div>
          <p class="muted" style="margin-top:12px">Demo: <b>admin / admin123</b> · <b>conductor / chofer123</b></p>
        </div>
        <div>
          <h2>Características</h2>
          <ul class="muted">
            <li>Selección de vehículo y vista de SOAT / Revisión Técnica</li>
            <li>Registro de km de salida y llegada (viajes)</li>
            <li>Papeletas de salida con número correlativo</li>
            <li>Módulo Admin: vehículos, conductores y papeletas</li>
            <li>Datos guardados en tu navegador (localStorage)</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- DRIVER VIEW -->
    <section id="viewDriver" class="hidden">
      <div class="card">
        <div class="section-title">
          <h2>Panel del Conductor</h2>
          <div class="toolbar">
            <select id="driverVehicleSelect"></select>
            <button class="btn" id="btnRefreshDriver">Actualizar</button>
          </div>
        </div>
        <div id="vehicleInfo" class="grid cols-3"></div>
      </div>

      <div class="grid cols-2" style="margin-top:16px">
        <div class="card">
          <div class="section-title"><h2>Nuevo registro de viaje</h2></div>
          <div class="row"><label>Vehículo</label><input id="tripVehiclePlate" disabled></div>
          <div class="row"><label>Fecha y hora</label><input id="tripDateTime" type="datetime-local"></div>
          <div class="row"><label>Km salida</label><input id="kmOut" type="number" min="0" placeholder="ej. 102350"></div>
          <div class="row"><label>Km llegada</label><input id="kmIn" type="number" min="0" placeholder="ej. 102780"></div>
          <div class="row"><label>Observaciones</label><input id="tripNotes" placeholder="opcional"></div>
          <div class="divider"></div>
          <div class="section-title"><h2>Papeleta de salida</h2><span class="chip" id="slipNextLabel">Siguiente N°: —</span></div>
          <div class="row"><label>Destino</label><input id="slipDest" placeholder="p.ej. Trujillo / Almacen Albo"></div>
          <div class="row"><label>Motivo</label><input id="slipPurpose" placeholder="p.ej. Entrega de mercancia"></div>
          <div class="row"><div></div>
            <div class="toolbar">
              <button class="btn" id="btnMakeSlip">Generar papeleta</button>
              <button class="btn primary" id="btnSaveTrip">Guardar viaje</button>
            </div>
          </div>
          <p id="tripHint" class="muted" style="margin-top:8px"></p>
        </div>
        <div class="card">
          <div class="section-title">
            <h2>Últimos viajes</h2>
            <div class="toolbar"><button class="btn gray" id="btnExportTrips">Exportar CSV</button></div>
          </div>
          <div style="overflow:auto">
            <table class="responsive">
              <thead><tr><th>Fecha</th><th>Conductor</th><th>Placa</th><th>Km salida</th><th>Km llegada</th><th>Recorrido</th><th>Obs.</th></tr></thead>
              <tbody id="tripsTableBody"></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- ADMIN VIEW -->
    <section id="viewAdmin" class="hidden">
      <div class="card">
        <div class="section-title"><h2>Panel de Administración</h2><div class="toolbar"><button class="btn" id="btnAdminReload">Actualizar</button></div></div>
        <div class="grid cols-2">
          <div class="card">
            <div class="section-title"><h2>Vehículos</h2><div class="toolbar"><button class="btn primary" id="btnAddVehicle">Nuevo vehículo</button></div></div>
            <div class="row"><label>Buscar</label><input id="vehicleSearch" placeholder="placa, marca, modelo"></div>
            <div style="overflow:auto; margin-top:10px">
              <table class="responsive">
                <thead><tr><th>Placa</th><th>Marca</th><th>Modelo</th><th>SOAT</th><th>Rev. Téc.</th><th>Odómetro</th><th></th></tr></thead>
                <tbody id="vehiclesTable"></tbody>
              </table>
            </div>
          </div>

          <div class="card">
            <div class="section-title"><h2>Usuarios</h2><div class="toolbar"><button class="btn primary" id="btnAddUser">Nuevo usuario</button></div></div>
            <div class="row"><label>Buscar</label><input id="userSearch" placeholder="usuario, nombre"></div>
            <div style="overflow:auto; margin-top:10px">
              <table class="responsive">
                <thead><tr><th>Usuario</th><th>Nombre</th><th>Rol</th><th>Vehículos asignados</th><th></th></tr></thead>
                <tbody id="usersTable"></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <div class="card" style="margin-top:16px">
        <div class="section-title"><h2>Papeletas de salida</h2><div class="toolbar"><input id="slipSearch" placeholder="buscar por número, placa, destino, conductor"></div></div>
        <div style="overflow:auto">
          <table class="responsive">
            <thead><tr><th>Número</th><th>Fecha</th><th>Conductor</th><th>Placa</th><th>Km salida</th><th>Destino</th><th>Motivo</th><th></th></tr></thead>
            <tbody id="slipsTable"></tbody>
          </table>
        </div>
      </div>

      <!-- FORMS -->
      <div class="grid cols-2" style="margin-top:16px">
        <div class="card">
          <div class="section-title"><h2 id="vehFormTitle">Crear / Editar Vehículo</h2></div>
          <div class="row"><label>Placa</label><input id="vehPlate" placeholder="ABC-123"></div>
          <div class="row"><label>Marca</label><input id="vehBrand" placeholder="Toyota"></div>
          <div class="row"><label>Modelo</label><input id="vehModel" placeholder="Hilux"></div>
          <div class="row"><label>SOAT vence</label><input id="vehSoat" type="date"></div>
          <div class="row"><label>Revisión Técnica vence</label><input id="vehTech" type="date"></div>
          <div class="row"><label>Odómetro actual</label><input id="vehOdo" type="number" min="0"></div>
          <div class="row"><div></div><div class="toolbar"><button class="btn" id="btnVehClear">Limpiar</button><button class="btn primary" id="btnVehSave">Guardar</button></div></div>
        </div>
        <div class="card">
          <div class="section-title"><h2 id="userFormTitle">Crear / Editar Usuario</h2></div>
          <div class="row"><label>Usuario (login)</label><input id="usrUsername" placeholder="chofer2"></div>
          <div class="row"><label>Nombre</label><input id="usrName" placeholder="Nombre y Apellido"></div>
          <div class="row"><label>Contraseña</label><input id="usrPassword" type="password" placeholder="••••••"></div>
          <div class="row"><label>Rol</label><select id="usrRole"><option value="driver">driver</option><option value="admin">admin</option></select></div>
          <div class="row"><label>Vehículos asignados</label><select id="usrVehicles" multiple size="5"></select></div>
          <div class="row"><div></div><div class="toolbar"><button class="btn" id="btnUserClear">Limpiar</button><button class="btn primary" id="btnUserSave">Guardar</button></div></div>
        </div>
      </div>
    </section>

    <p class="footer">Proyecto Control vehicular. <br>Hecho con HTML + JS (sin framework). Tus datos se guardan localmente en el navegador.</p>
  </div>

  <script>
 const _0x1be814=_0x2afe;(function(_0x673192,_0x3adb12){const _0x1c0873=_0x2afe,_0x4eaf22=_0x673192();while(!![]){try{const _0xf5db7e=parseInt(_0x1c0873(0x1b1))/0x1*(parseInt(_0x1c0873(0x1c1))/0x2)+-parseInt(_0x1c0873(0x1d5))/0x3+-parseInt(_0x1c0873(0x1a5))/0x4*(-parseInt(_0x1c0873(0x142))/0x5)+parseInt(_0x1c0873(0x219))/0x6*(-parseInt(_0x1c0873(0x1a3))/0x7)+parseInt(_0x1c0873(0x227))/0x8+parseInt(_0x1c0873(0x1e9))/0x9*(-parseInt(_0x1c0873(0x1b7))/0xa)+parseInt(_0x1c0873(0x21a))/0xb;if(_0xf5db7e===_0x3adb12)break;else _0x4eaf22['push'](_0x4eaf22['shift']());}catch(_0x4c0236){_0x4eaf22['push'](_0x4eaf22['shift']());}}}(_0x4d61,0xdf0e8));const VERSION=_0x1be814(0x12f),el=_0x8b2e71=>document[_0x1be814(0x15e)](_0x8b2e71),$=(_0x464938,_0x390d40=document)=>_0x390d40[_0x1be814(0x20f)](_0x464938),$$=(_0x3be54a,_0x1e5241=document)=>Array[_0x1be814(0x216)](_0x1e5241[_0x1be814(0x1df)](_0x3be54a)),fmtNum=_0x265a8f=>_0x265a8f===null||_0x265a8f===undefined||_0x265a8f===''?'':Number(_0x265a8f)['toLocaleString'](),fmtDate=_0x3e6515=>new Date(_0x3e6515)['toLocaleString'](),fmtDay=_0xe32aa2=>new Date(_0xe32aa2)['toLocaleDateString'](),daysLeft=_0x43bf87=>Math['ceil']((new Date(_0x43bf87)[_0x1be814(0x1bd)](0x0,0x0,0x0,0x0)-new Date()['setHours'](0x0,0x0,0x0,0x0))/0x5265c00),statusBadge=_0x516296=>{const _0x443727=_0x1be814,_0x3d2365=daysLeft(_0x516296);if(_0x3d2365<0x0)return _0x443727(0x197)+Math[_0x443727(0x211)](_0x3d2365)+_0x443727(0x1bb);if(_0x3d2365<=0x1e)return'<span\x20class=\x22badge\x20warn\x22>Por\x20vencer\x20('+_0x3d2365+_0x443727(0x1bb);return'<span\x20class=\x22badge\x20ok\x22>Vigente\x20('+_0x3d2365+'\x20días)</span>';};function applyResponsiveTableLabels(_0x176689=document){const _0x35a395=_0x1be814;$$(_0x35a395(0x1d7),_0x176689)[_0x35a395(0x189)](_0x25b629=>{const _0x36db6b=_0x35a395,_0x26465d=Array[_0x36db6b(0x216)](_0x25b629[_0x36db6b(0x1df)](_0x36db6b(0x20a)))[_0x36db6b(0x20b)](_0x57c48a=>_0x57c48a[_0x36db6b(0x201)][_0x36db6b(0x1c5)]());_0x25b629[_0x36db6b(0x1df)](_0x36db6b(0x1ea))['forEach'](_0x5d5474=>{const _0x57b5aa=_0x36db6b;Array[_0x57b5aa(0x216)](_0x5d5474['children'])[_0x57b5aa(0x189)]((_0x595555,_0x453977)=>_0x595555[_0x57b5aa(0x213)]('data-th',_0x26465d[_0x453977]||''));});});}const store={'key':_0x1be814(0x187),'load'(){const _0x6c7e9f=_0x1be814,_0x49c8f9=localStorage[_0x6c7e9f(0x1c0)](this[_0x6c7e9f(0x21b)]);if(!_0x49c8f9){const _0xae75e=this[_0x6c7e9f(0x13d)]();return this[_0x6c7e9f(0x152)](_0xae75e),_0xae75e;}try{return JSON[_0x6c7e9f(0x161)](_0x49c8f9);}catch{return this[_0x6c7e9f(0x13d)]();}},'save'(_0x36c00f){const _0x3febd1=_0x1be814;localStorage[_0x3febd1(0x210)](this[_0x3febd1(0x21b)],JSON[_0x3febd1(0x15a)](_0x36c00f));},'seed'(){const _0x853211=_0x1be814,_0x523ce6=new Date(),_0x565e76=_0x4b1f42=>new Date(_0x523ce6['getTime']()+_0x4b1f42*0x5265c00)['toISOString']()['slice'](0x0,0xa);return{'users':[{'id':'u1','username':_0x853211(0x15c),'name':'Administrador','password':_0x853211(0x204),'role':_0x853211(0x15c),'vehicleIds':[]},{'id':'u2','username':'conductor','name':_0x853211(0x18e),'password':'chofer123','role':_0x853211(0x1d3),'vehicleIds':['v1','v2']}],'vehicles':[{'id':'v1','plate':_0x853211(0x19e),'brand':_0x853211(0x183),'model':_0x853211(0x177),'soat':_0x565e76(0x78),'tech':_0x565e76(0x2d),'odometer':0x18fce},{'id':'v2','plate':_0x853211(0x16d),'brand':_0x853211(0x16c),'model':'H1','soat':_0x565e76(-0xa),'tech':_0x565e76(0xc8),'odometer':0x4f4c}],'trips':[{'id':'t1','dt':new Date()['toISOString'](),'driverId':'u2','plate':_0x853211(0x19e),'kmOut':0x18e70,'kmIn':0x18fb0,'notes':'Entrega\x20Mercancia'}],'slips':[],'meta':{'slipSeq':0x0}};}};let db=store[_0x1be814(0x1d9)]();db[_0x1be814(0x1f7)]=Array[_0x1be814(0x17a)](db[_0x1be814(0x1f7)])?db[_0x1be814(0x1f7)]:[],db[_0x1be814(0x218)]=db['meta']||{'slipSeq':0x0};const maxSlipNo=db[_0x1be814(0x1f7)][_0x1be814(0x178)]((_0x1ad96c,_0x45de35)=>Math[_0x1be814(0x154)](_0x1ad96c,Number(_0x45de35[_0x1be814(0x184)]||0x0)),0x0);if(db[_0x1be814(0x218)][_0x1be814(0x1ac)]<maxSlipNo)db[_0x1be814(0x218)]['slipSeq']=maxSlipNo;store[_0x1be814(0x152)](db);let session={'user':null};function show(_0x2b4072){const _0x4cf3d7=_0x1be814;[_0x4cf3d7(0x1b6),_0x4cf3d7(0x1e1),_0x4cf3d7(0x1f0)][_0x4cf3d7(0x189)](_0x3d3fe5=>el(_0x3d3fe5)[_0x4cf3d7(0x1c8)][_0x4cf3d7(0x172)]('hidden')),el(_0x2b4072)[_0x4cf3d7(0x1c8)]['remove'](_0x4cf3d7(0x17c));}function refreshWho(){const _0x1441da=_0x1be814;el(_0x1441da(0x220))['textContent']=session[_0x1441da(0x196)]?session['user'][_0x1441da(0x205)]+_0x1441da(0x222)+session[_0x1441da(0x196)]['role']:'',el(_0x1441da(0x1c3))[_0x1441da(0x1c8)][_0x1441da(0x1a4)]('hidden',!session[_0x1441da(0x196)]);}el(_0x1be814(0x156))['addEventListener'](_0x1be814(0x1d2),()=>{const _0x3eb9d2=_0x1be814,_0x345dc2=el(_0x3eb9d2(0x223))[_0x3eb9d2(0x1c7)]['trim'](),_0x3a1b92=el(_0x3eb9d2(0x14c))[_0x3eb9d2(0x1c7)],_0x1978fa=db[_0x3eb9d2(0x194)][_0x3eb9d2(0x1db)](_0x3b55f7=>_0x3b55f7[_0x3eb9d2(0x1f3)]===_0x345dc2&&_0x3b55f7[_0x3eb9d2(0x193)]===_0x3a1b92);if(!_0x1978fa){alert(_0x3eb9d2(0x130));return;}session['user']=_0x1978fa,el(_0x3eb9d2(0x14c))[_0x3eb9d2(0x1c7)]='',refreshWho(),_0x1978fa['role']===_0x3eb9d2(0x15c)?renderAdmin():renderDriver();}),el(_0x1be814(0x1c3))[_0x1be814(0x148)](_0x1be814(0x1d2),()=>{const _0x59d8fc=_0x1be814;session['user']=null,refreshWho(),show(_0x59d8fc(0x1b6));});function getNextSlipNumber(){const _0x502fcd=_0x1be814,_0x306140=db[_0x502fcd(0x1f7)]['reduce']((_0x33b593,_0x5abe8c)=>Math['max'](_0x33b593,Number(_0x5abe8c['number']||0x0)),0x0);return Math['max'](db['meta'][_0x502fcd(0x1ac)]||0x0,_0x306140)+0x1;}function renderDriver(){const _0x57206a=_0x1be814,_0x1ee2af=session[_0x57206a(0x196)]['vehicleIds']&&session[_0x57206a(0x196)][_0x57206a(0x13a)][_0x57206a(0x1bc)]?session[_0x57206a(0x196)][_0x57206a(0x13a)]:db[_0x57206a(0x180)][_0x57206a(0x20b)](_0x57d00e=>_0x57d00e['id']),_0x4b6cc9=db[_0x57206a(0x180)][_0x57206a(0x145)](_0x35d6d5=>_0x1ee2af[_0x57206a(0x1e7)](_0x35d6d5['id'])!==-0x1),_0x1fb5d3=el('driverVehicleSelect');_0x1fb5d3[_0x57206a(0x163)]=_0x4b6cc9[_0x57206a(0x20b)](_0x5149bd=>_0x57206a(0x14f)+_0x5149bd['id']+'\x22>'+_0x5149bd[_0x57206a(0x135)]+_0x57206a(0x222)+_0x5149bd[_0x57206a(0x179)]+'\x20'+_0x5149bd[_0x57206a(0x200)]+'</option>')[_0x57206a(0x167)](''),_0x1fb5d3[_0x57206a(0x1fa)]=onDriverSelectChange,_0x1fb5d3['value']=_0x4b6cc9[0x0]?_0x4b6cc9[0x0]['id']:'',onDriverSelectChange(),show(_0x57206a(0x1e1));}function onDriverSelectChange(){const _0x2f3e89=_0x1be814,_0x2a3440=el(_0x2f3e89(0x202))[_0x2f3e89(0x1c7)],_0x17d4bf=db[_0x2f3e89(0x180)][_0x2f3e89(0x1db)](_0x31d87a=>_0x31d87a['id']===_0x2a3440);if(!_0x17d4bf){el(_0x2f3e89(0x206))[_0x2f3e89(0x163)]='';return;}el(_0x2f3e89(0x1e4))[_0x2f3e89(0x1c7)]=_0x17d4bf[_0x2f3e89(0x135)],el('tripDateTime')[_0x2f3e89(0x1c7)]=new Date()['toISOString']()[_0x2f3e89(0x1f5)](0x0,0x10),el(_0x2f3e89(0x1ae))['textContent']=_0x2f3e89(0x136)+fmtNum(_0x17d4bf['odometer'])+_0x2f3e89(0x19f);const _0x5c8202=getNextSlipNumber(),_0x24b238=String(_0x5c8202)[_0x2f3e89(0x1fc)](0x4,'0'),_0x24d55f=el(_0x2f3e89(0x1a7));if(_0x24d55f)_0x24d55f[_0x2f3e89(0x201)]='Siguiente\x20N°:\x20'+_0x24b238;const _0x9148ae='\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x22>\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22section-title\x22><h2>Vehículo</h2></div>\x20\x20\x20\x20\x20\x20\x20\x20<p><b>'+_0x17d4bf[_0x2f3e89(0x135)]+_0x2f3e89(0x1e0)+_0x17d4bf[_0x2f3e89(0x179)]+'\x20'+_0x17d4bf['model']+_0x2f3e89(0x173)+fmtNum(_0x17d4bf[_0x2f3e89(0x1cf)])+'\x20km</p>\x20\x20\x20\x20\x20\x20</div>\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x22>\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22section-title\x22><h2>SOAT</h2></div>\x20\x20\x20\x20\x20\x20\x20\x20<p>Vence:\x20<b>'+fmtDay(_0x17d4bf['soat'])+_0x2f3e89(0x188)+statusBadge(_0x17d4bf[_0x2f3e89(0x1e2)])+_0x2f3e89(0x1eb)+fmtDay(_0x17d4bf['tech'])+_0x2f3e89(0x188)+statusBadge(_0x17d4bf[_0x2f3e89(0x139)])+_0x2f3e89(0x1a9);el(_0x2f3e89(0x206))[_0x2f3e89(0x163)]=_0x9148ae;const _0xb2228=el('tripsTableBody'),_0x1dba35=db[_0x2f3e89(0x13e)]['filter'](_0x238d2c=>_0x238d2c[_0x2f3e89(0x135)]===_0x17d4bf[_0x2f3e89(0x135)])[_0x2f3e89(0x15d)]((_0x2b3d97,_0x481f37)=>new Date(_0x481f37['dt'])-new Date(_0x2b3d97['dt']))['slice'](0x0,0x32);_0xb2228[_0x2f3e89(0x163)]=_0x1dba35[_0x2f3e89(0x20b)](_0x5128e0=>{const _0x34c167=_0x2f3e89,_0x51e8a6=(db[_0x34c167(0x194)]['find'](_0x5f3e71=>_0x5f3e71['id']===_0x5128e0[_0x34c167(0x20e)])||{})[_0x34c167(0x205)]||'—',_0x251067=_0x5128e0[_0x34c167(0x1e8)]-_0x5128e0['kmOut'];return _0x34c167(0x131)+_0x34c167(0x1a2)+fmtDate(_0x5128e0['dt'])+_0x34c167(0x1c9)+_0x51e8a6+_0x34c167(0x1c9)+_0x5128e0[_0x34c167(0x135)]+_0x34c167(0x14e)+_0x34c167(0x1a2)+fmtNum(_0x5128e0[_0x34c167(0x1cb)])+_0x34c167(0x1c9)+fmtNum(_0x5128e0[_0x34c167(0x1e8)])+_0x34c167(0x14e)+_0x34c167(0x1a2)+fmtNum(_0x251067)+_0x34c167(0x19b)+(_0x5128e0[_0x34c167(0x1ad)]||'')+_0x34c167(0x14e)+'</tr>';})[_0x2f3e89(0x167)](''),applyResponsiveTableLabels(el('viewDriver'));}el(_0x1be814(0x149))[_0x1be814(0x148)](_0x1be814(0x1d2),renderDriver);function validateTrip(_0x7cb1b6,_0x17997a,_0x28a57c){const _0x296ade=_0x1be814;if(_0x17997a<0x0||_0x28a57c<0x0)return _0x296ade(0x1f6);if(_0x28a57c<_0x17997a)return _0x296ade(0x13b);const _0x2c4119=db[_0x296ade(0x13e)][_0x296ade(0x145)](_0x4367a1=>_0x4367a1[_0x296ade(0x135)]===_0x7cb1b6['plate'])['sort']((_0x35a49c,_0x3e592e)=>new Date(_0x3e592e['dt'])-new Date(_0x35a49c['dt']))[0x0],_0xa15954=_0x2c4119?_0x2c4119[_0x296ade(0x1e8)]:_0x7cb1b6[_0x296ade(0x1cf)];if(_0x17997a<_0xa15954)return _0x296ade(0x1de)+_0x17997a+_0x296ade(0x19a)+_0xa15954+')';return null;}function _0x2afe(_0x578691,_0xb9ce1){const _0x4d61f4=_0x4d61();return _0x2afe=function(_0x2afe91,_0x42c7fe){_0x2afe91=_0x2afe91-0x12f;let _0x32a5e5=_0x4d61f4[_0x2afe91];return _0x32a5e5;},_0x2afe(_0x578691,_0xb9ce1);}el(_0x1be814(0x157))[_0x1be814(0x148)](_0x1be814(0x1d2),()=>{const _0x4caa00=_0x1be814,_0x399956=el(_0x4caa00(0x202))['value'],_0xbfc6eb=db[_0x4caa00(0x180)]['find'](_0x4ac967=>_0x4ac967['id']===_0x399956),_0x308f00=Number(el(_0x4caa00(0x1cb))[_0x4caa00(0x1c7)]),_0x56fa61=Number(el(_0x4caa00(0x1e8))[_0x4caa00(0x1c7)]),_0x49ba30=new Date(el(_0x4caa00(0x18f))[_0x4caa00(0x1c7)]||new Date())[_0x4caa00(0x1ec)](),_0x5782d1=el(_0x4caa00(0x1f9))['value']['trim'](),_0x285d0d=validateTrip(_0xbfc6eb,_0x308f00,_0x56fa61);if(_0x285d0d){alert(_0x285d0d);return;}const _0x550bf2=crypto['randomUUID']?crypto[_0x4caa00(0x143)]():String(Date['now']()),_0x204909={'id':'t'+_0x550bf2,'dt':_0x49ba30,'driverId':session[_0x4caa00(0x196)]['id'],'plate':_0xbfc6eb[_0x4caa00(0x135)],'kmOut':_0x308f00,'kmIn':_0x56fa61,'notes':_0x5782d1};db['trips'][_0x4caa00(0x19c)](_0x204909),_0xbfc6eb[_0x4caa00(0x1cf)]=Math[_0x4caa00(0x154)](_0xbfc6eb[_0x4caa00(0x1cf)],_0x56fa61),store[_0x4caa00(0x152)](db),el('kmOut')['value']='',el(_0x4caa00(0x1e8))['value']='',el('tripNotes')[_0x4caa00(0x1c7)]='',renderDriver(),alert(_0x4caa00(0x1fd));}),el(_0x1be814(0x1d4))[_0x1be814(0x148)](_0x1be814(0x1d2),()=>{const _0x556351=_0x1be814,_0x5066fd=el(_0x556351(0x202))['value'],_0x546d46=db[_0x556351(0x180)][_0x556351(0x1db)](_0x4026a3=>_0x4026a3['id']===_0x5066fd),_0x29821c=[[_0x556351(0x225),_0x556351(0x175),'Placa',_0x556351(0x1ed),'Km\x20llegada',_0x556351(0x17d),_0x556351(0x1ff)]];db[_0x556351(0x13e)][_0x556351(0x145)](_0x24382e=>_0x24382e['plate']===_0x546d46[_0x556351(0x135)])[_0x556351(0x189)](_0x297801=>{const _0x2f06cc=_0x556351,_0x4995e4=(db[_0x2f06cc(0x194)][_0x2f06cc(0x1db)](_0xe7e321=>_0xe7e321['id']===_0x297801['driverId'])||{})[_0x2f06cc(0x205)]||'';_0x29821c['push']([fmtDate(_0x297801['dt']),_0x4995e4,_0x297801[_0x2f06cc(0x135)],_0x297801[_0x2f06cc(0x1cb)],_0x297801[_0x2f06cc(0x1e8)],_0x297801['kmIn']-_0x297801[_0x2f06cc(0x1cb)],_0x297801['notes']||'']);});const _0x47f4dd=_0x29821c[_0x556351(0x20b)](_0x35d0b7=>_0x35d0b7['map'](_0xccf098=>'\x22'+String(_0xccf098)[_0x556351(0x13c)](/"/g,'\x22\x22')+'\x22')[_0x556351(0x167)](','))[_0x556351(0x167)](''),_0x5d8743=new Blob([_0x47f4dd],{'type':_0x556351(0x16a)}),_0x180a52=document[_0x556351(0x176)]('a');_0x180a52[_0x556351(0x1dd)]=URL[_0x556351(0x1f1)](_0x5d8743),_0x180a52['download']='viajes_'+_0x546d46[_0x556351(0x135)]+_0x556351(0x144),_0x180a52[_0x556351(0x1d2)]();});function openSlipPrint(_0x4e5cc7){const _0x29dcea=_0x1be814,_0x19ba96=window[_0x29dcea(0x18a)]('',_0x29dcea(0x16b)),_0x2a4ff1=_0x19ba96['document'];_0x2a4ff1[_0x29dcea(0x18a)]();const _0x430c32=_0x2a4ff1[_0x29dcea(0x1b9)]||_0x2a4ff1[_0x29dcea(0x176)]('html');if(!_0x2a4ff1[_0x29dcea(0x1b9)])_0x2a4ff1[_0x29dcea(0x150)](_0x430c32);const _0x536826=_0x2a4ff1[_0x29dcea(0x1a1)]||_0x2a4ff1[_0x29dcea(0x176)](_0x29dcea(0x1a1));if(!_0x2a4ff1[_0x29dcea(0x1a1)])_0x430c32[_0x29dcea(0x150)](_0x536826);const _0x1216b1=_0x2a4ff1['createElement'](_0x29dcea(0x218));_0x1216b1[_0x29dcea(0x213)](_0x29dcea(0x162),_0x29dcea(0x221)),_0x536826[_0x29dcea(0x150)](_0x1216b1);const _0xd1e246=_0x2a4ff1[_0x29dcea(0x176)](_0x29dcea(0x21f));_0xd1e246['textContent']=_0x29dcea(0x1aa)+String(_0x4e5cc7[_0x29dcea(0x184)])['padStart'](0x4,'0'),_0x536826[_0x29dcea(0x150)](_0xd1e246);const _0x373898=_0x2a4ff1[_0x29dcea(0x176)]('style');_0x373898['textContent']='body{font-family:Inter,Arial;margin:24px;color:#0b1020}'+_0x29dcea(0x1d6)+_0x29dcea(0x224)+'.box{border:1px\x20solid\x20#e5e7eb;border-radius:10px;padding:10px}.line{border-top:1px\x20dashed\x20#9ca3af;margin:24px\x200}'+_0x29dcea(0x1af),_0x536826[_0x29dcea(0x150)](_0x373898);const _0x31cb7c=_0x2a4ff1['body']||_0x2a4ff1['createElement'](_0x29dcea(0x207));if(!_0x2a4ff1[_0x29dcea(0x207)])_0x430c32[_0x29dcea(0x150)](_0x31cb7c);const _0x77626d=_0x2a4ff1[_0x29dcea(0x176)](_0x29dcea(0x133));_0x77626d[_0x29dcea(0x169)]['display']=_0x29dcea(0x21d),_0x77626d[_0x29dcea(0x169)][_0x29dcea(0x1ce)]=_0x29dcea(0x1da),_0x77626d['style'][_0x29dcea(0x1c2)]=_0x29dcea(0x226);const _0x2bd552=_0x2a4ff1[_0x29dcea(0x176)]('h1');_0x2bd552[_0x29dcea(0x201)]='Papeleta\x20de\x20salida',_0x77626d[_0x29dcea(0x150)](_0x2bd552);const _0x114933=_0x2a4ff1[_0x29dcea(0x176)](_0x29dcea(0x133)),_0x8ef4c6=_0x2a4ff1[_0x29dcea(0x176)]('b');_0x8ef4c6[_0x29dcea(0x201)]='N°\x20'+String(_0x4e5cc7[_0x29dcea(0x184)])['padStart'](0x4,'0'),_0x114933[_0x29dcea(0x150)](_0x8ef4c6);const _0x4fccba=_0x2a4ff1[_0x29dcea(0x176)](_0x29dcea(0x133));_0x4fccba[_0x29dcea(0x15b)]=_0x29dcea(0x146),_0x4fccba['textContent']=new Date(_0x4e5cc7['dt'])['toLocaleString'](),_0x114933[_0x29dcea(0x150)](_0x4fccba),_0x77626d[_0x29dcea(0x150)](_0x114933);const _0x110486=_0x2a4ff1[_0x29dcea(0x176)](_0x29dcea(0x133));_0x110486[_0x29dcea(0x15b)]=_0x29dcea(0x170),_0x110486[_0x29dcea(0x150)](_0x77626d);const _0x32b996=_0x2a4ff1[_0x29dcea(0x176)](_0x29dcea(0x133));_0x32b996[_0x29dcea(0x15b)]='grid';const _0x530b6c=(db[_0x29dcea(0x194)][_0x29dcea(0x1db)](_0x3177ff=>_0x3177ff['id']===_0x4e5cc7[_0x29dcea(0x20e)])||{})[_0x29dcea(0x205)]||'',_0x5c4b43=(_0x10b206,_0x4ac87a)=>{const _0x5b4db6=_0x29dcea,_0x4c7346=_0x2a4ff1[_0x5b4db6(0x176)](_0x5b4db6(0x133));_0x4c7346[_0x5b4db6(0x15b)]=_0x5b4db6(0x228);const _0x3309d8=_0x2a4ff1['createElement']('div');_0x3309d8[_0x5b4db6(0x15b)]='muted',_0x3309d8[_0x5b4db6(0x201)]=_0x10b206;const _0xa565eb=_0x2a4ff1[_0x5b4db6(0x176)](_0x5b4db6(0x133)),_0x3b5103=_0x2a4ff1[_0x5b4db6(0x176)]('b');return _0x3b5103[_0x5b4db6(0x201)]=_0x4ac87a,_0xa565eb['appendChild'](_0x3b5103),_0x4c7346[_0x5b4db6(0x150)](_0x3309d8),_0x4c7346[_0x5b4db6(0x150)](_0xa565eb),_0x4c7346;};_0x32b996['appendChild'](_0x5c4b43('Conductor',_0x530b6c)),_0x32b996[_0x29dcea(0x150)](_0x5c4b43(_0x29dcea(0x18b),_0x4e5cc7[_0x29dcea(0x135)]||'')),_0x32b996['appendChild'](_0x5c4b43(_0x29dcea(0x1ed),_0x4e5cc7[_0x29dcea(0x1cb)]==null?'':Number(_0x4e5cc7['kmOut'])['toLocaleString']())),_0x32b996[_0x29dcea(0x150)](_0x5c4b43(_0x29dcea(0x16f),_0x4e5cc7[_0x29dcea(0x141)]||''));const _0x23bebe=_0x5c4b43(_0x29dcea(0x19d),_0x4e5cc7[_0x29dcea(0x16e)]||'');_0x23bebe[_0x29dcea(0x169)][_0x29dcea(0x1fe)]=_0x29dcea(0x17e),_0x32b996[_0x29dcea(0x150)](_0x23bebe);const _0x27a342=_0x2a4ff1[_0x29dcea(0x176)](_0x29dcea(0x133));_0x27a342[_0x29dcea(0x15b)]='line';const _0xe82e89=_0x2a4ff1[_0x29dcea(0x176)]('div');_0xe82e89['className']='grid',_0xe82e89[_0x29dcea(0x150)](_0x5c4b43(_0x29dcea(0x185),'')),_0xe82e89[_0x29dcea(0x150)](_0x5c4b43(_0x29dcea(0x1b2),''));const _0x1769aa=_0x2a4ff1[_0x29dcea(0x176)]('p');_0x1769aa[_0x29dcea(0x15b)]=_0x29dcea(0x146),_0x1769aa[_0x29dcea(0x169)]['marginTop']=_0x29dcea(0x217),_0x1769aa[_0x29dcea(0x201)]=_0x29dcea(0x166);const _0x2993cb=_0x2a4ff1[_0x29dcea(0x176)]('div');_0x2993cb[_0x29dcea(0x15b)]='no-print',_0x2993cb[_0x29dcea(0x169)]['marginTop']='12px';const _0x9f585d=_0x2a4ff1[_0x29dcea(0x176)](_0x29dcea(0x212));_0x9f585d[_0x29dcea(0x201)]='Imprimir',_0x9f585d['onclick']=()=>_0x19ba96[_0x29dcea(0x164)](),_0x2993cb[_0x29dcea(0x150)](_0x9f585d),_0x110486[_0x29dcea(0x150)](_0x32b996),_0x110486['appendChild'](_0x27a342),_0x110486[_0x29dcea(0x150)](_0xe82e89),_0x110486[_0x29dcea(0x150)](_0x1769aa),_0x110486[_0x29dcea(0x150)](_0x2993cb),_0x31cb7c[_0x29dcea(0x150)](_0x110486),_0x2a4ff1[_0x29dcea(0x199)]();}function createSlipFromInputs(){const _0xab9a7f=_0x1be814,_0x3714bd=el(_0xab9a7f(0x202))[_0xab9a7f(0x1c7)],_0x4b840c=db['vehicles'][_0xab9a7f(0x1db)](_0x3bcc7d=>_0x3bcc7d['id']===_0x3714bd);if(!_0x4b840c){alert(_0xab9a7f(0x1a8));return;}const _0x915a88=Number(el(_0xab9a7f(0x1cb))[_0xab9a7f(0x1c7)]||_0x4b840c[_0xab9a7f(0x1cf)]||0x0);if(_0x915a88<0x0){alert(_0xab9a7f(0x20c));return;}const _0x33360a=new Date(el('tripDateTime')[_0xab9a7f(0x1c7)]||new Date())[_0xab9a7f(0x1ec)](),_0x4ca7b4=el('slipDest')[_0xab9a7f(0x1c7)][_0xab9a7f(0x1c5)](),_0x3c1cbf=el(_0xab9a7f(0x1dc))[_0xab9a7f(0x1c7)][_0xab9a7f(0x1c5)](),_0x2d9b54=getNextSlipNumber(),_0x4c4946=crypto[_0xab9a7f(0x143)]?crypto['randomUUID']():String(Date[_0xab9a7f(0x190)]()),_0x4c972f={'id':'s'+_0x4c4946,'number':_0x2d9b54,'dt':_0x33360a,'driverId':session[_0xab9a7f(0x196)]['id'],'plate':_0x4b840c[_0xab9a7f(0x135)],'kmOut':_0x915a88,'destination':_0x4ca7b4,'purpose':_0x3c1cbf};db['slips'][_0xab9a7f(0x19c)](_0x4c972f),db['meta'][_0xab9a7f(0x1ac)]=_0x2d9b54,store['save'](db),el(_0xab9a7f(0x1b5))[_0xab9a7f(0x1c7)]='',el(_0xab9a7f(0x1dc))[_0xab9a7f(0x1c7)]='';if(!el(_0xab9a7f(0x1f0))[_0xab9a7f(0x1c8)]['contains'](_0xab9a7f(0x17c)))renderSlipsTable();const _0x36964a=el(_0xab9a7f(0x1a7));if(_0x36964a){const _0x4ac1b1=getNextSlipNumber();_0x36964a['textContent']=_0xab9a7f(0x14a)+String(_0x4ac1b1)[_0xab9a7f(0x1fc)](0x4,'0');}openSlipPrint(_0x4c972f);}const btnMakeSlip=document[_0x1be814(0x15e)](_0x1be814(0x171));if(btnMakeSlip)btnMakeSlip[_0x1be814(0x148)](_0x1be814(0x1d2),createSlipFromInputs);function renderAdmin(){const _0xb21b10=_0x1be814;show(_0xb21b10(0x1f0)),renderVehiclesTable(),renderUsersTable(),renderSlipsTable(),fillUserVehicleOptions();}function renderVehiclesTable(){const _0x5f27eb=_0x1be814,_0x2a6cce=(el('vehicleSearch')[_0x5f27eb(0x1c7)]||'')[_0x5f27eb(0x1c5)]()['toLowerCase'](),_0x1a5da1=el('vehiclesTable'),_0x4883c5=db[_0x5f27eb(0x180)]['filter'](_0xc24c83=>(_0xc24c83[_0x5f27eb(0x135)]+'\x20'+_0xc24c83[_0x5f27eb(0x179)]+'\x20'+_0xc24c83[_0x5f27eb(0x200)])[_0x5f27eb(0x18d)]()[_0x5f27eb(0x1e7)](_0x2a6cce)!==-0x1);_0x1a5da1[_0x5f27eb(0x163)]=_0x4883c5['map'](_0x2cc678=>{const _0x3ff31c=_0x5f27eb;return'<tr>'+'<td>'+_0x2cc678[_0x3ff31c(0x135)]+_0x3ff31c(0x1c9)+_0x2cc678[_0x3ff31c(0x179)]+_0x3ff31c(0x1c9)+_0x2cc678[_0x3ff31c(0x200)]+_0x3ff31c(0x14e)+_0x3ff31c(0x1a2)+fmtDay(_0x2cc678[_0x3ff31c(0x1e2)])+_0x3ff31c(0x140)+statusBadge(_0x2cc678[_0x3ff31c(0x1e2)])+_0x3ff31c(0x14e)+_0x3ff31c(0x1a2)+fmtDay(_0x2cc678[_0x3ff31c(0x139)])+'<br>'+statusBadge(_0x2cc678[_0x3ff31c(0x139)])+'</td>'+_0x3ff31c(0x1a2)+fmtNum(_0x2cc678[_0x3ff31c(0x1cf)])+_0x3ff31c(0x13f)+_0x3ff31c(0x192)+'<button\x20class=\x22btn\x22\x20data-edit-veh=\x22'+_0x2cc678['id']+_0x3ff31c(0x17f)+_0x3ff31c(0x168)+_0x2cc678['id']+_0x3ff31c(0x159)+_0x3ff31c(0x14d)+_0x3ff31c(0x15f);})[_0x5f27eb(0x167)](''),$$('[data-edit-veh]')[_0x5f27eb(0x189)](_0xb880a3=>_0xb880a3[_0x5f27eb(0x153)]=()=>loadVehicleToForm(_0xb880a3['getAttribute']('data-edit-veh'))),$$(_0x5f27eb(0x20d))[_0x5f27eb(0x189)](_0x3b0124=>_0x3b0124[_0x5f27eb(0x153)]=()=>deleteVehicle(_0x3b0124[_0x5f27eb(0x147)](_0x5f27eb(0x182)))),applyResponsiveTableLabels(el('viewAdmin'));}function renderUsersTable(){const _0x184088=_0x1be814,_0x35c5b3=(el(_0x184088(0x1cc))[_0x184088(0x1c7)]||'')[_0x184088(0x1c5)]()[_0x184088(0x18d)](),_0x3c4ccf=el(_0x184088(0x1be)),_0x14c3ab=db[_0x184088(0x194)][_0x184088(0x145)](_0x1421f4=>(_0x1421f4[_0x184088(0x1f3)]+'\x20'+_0x1421f4[_0x184088(0x205)]+'\x20'+_0x1421f4[_0x184088(0x137)])[_0x184088(0x18d)]()[_0x184088(0x1e7)](_0x35c5b3)!==-0x1);_0x3c4ccf[_0x184088(0x163)]=_0x14c3ab[_0x184088(0x20b)](_0x5bec5f=>{const _0x4cead9=_0x184088,_0x2b8b88=(_0x5bec5f[_0x4cead9(0x13a)]||[])[_0x4cead9(0x20b)](_0x36e2f8=>(db[_0x4cead9(0x180)][_0x4cead9(0x1db)](_0x229098=>_0x229098['id']===_0x36e2f8)||{})[_0x4cead9(0x135)])[_0x4cead9(0x145)](Boolean)[_0x4cead9(0x167)](',\x20');return _0x4cead9(0x131)+'<td>'+_0x5bec5f['username']+'</td><td>'+_0x5bec5f['name']+_0x4cead9(0x1c9)+_0x5bec5f[_0x4cead9(0x137)]+_0x4cead9(0x1c9)+_0x2b8b88+_0x4cead9(0x14e)+'<td><div\x20class=\x22toolbar\x22>'+_0x4cead9(0x1d1)+_0x5bec5f['id']+'\x22>Editar</button>'+(_0x5bec5f[_0x4cead9(0x1f3)]==='admin'?'':_0x4cead9(0x209)+_0x5bec5f['id']+_0x4cead9(0x159))+_0x4cead9(0x14d)+_0x4cead9(0x15f);})['join'](''),$$(_0x184088(0x1e3))[_0x184088(0x189)](_0x3a2f51=>_0x3a2f51[_0x184088(0x153)]=()=>loadUserToForm(_0x3a2f51[_0x184088(0x147)](_0x184088(0x1fb)))),$$(_0x184088(0x203))[_0x184088(0x189)](_0x22891a=>_0x22891a['onclick']=()=>deleteUser(_0x22891a[_0x184088(0x147)](_0x184088(0x1b4)))),applyResponsiveTableLabels(el(_0x184088(0x1f0)));}function renderSlipsTable(){const _0x379a15=_0x1be814,_0x42482a=(el(_0x379a15(0x1f2))?el('slipSearch')[_0x379a15(0x1c7)]:'')[_0x379a15(0x1c5)]()[_0x379a15(0x18d)](),_0xffad8a=el(_0x379a15(0x174));if(!_0xffad8a)return;const _0x37bf07=db['slips'][_0x379a15(0x1f5)]()[_0x379a15(0x15d)]((_0x306c4a,_0x517881)=>_0x517881['number']-_0x306c4a['number'])[_0x379a15(0x145)](_0x36c134=>{const _0x304322=_0x379a15,_0x4ddff8=(db[_0x304322(0x194)][_0x304322(0x1db)](_0x311542=>_0x311542['id']===_0x36c134[_0x304322(0x20e)])||{})[_0x304322(0x205)]||'',_0x54975a=(_0x36c134['number']+'\x20'+_0x36c134['plate']+'\x20'+(_0x36c134[_0x304322(0x141)]||'')+'\x20'+(_0x36c134[_0x304322(0x16e)]||'')+'\x20'+_0x4ddff8)['toLowerCase']();return _0x54975a[_0x304322(0x1e7)](_0x42482a)!==-0x1;})[_0x379a15(0x20b)](_0x7b9744=>{const _0x2215e4=_0x379a15,_0x41e8b1=(db[_0x2215e4(0x194)][_0x2215e4(0x1db)](_0x2eb036=>_0x2eb036['id']===_0x7b9744[_0x2215e4(0x20e)])||{})[_0x2215e4(0x205)]||'';return'<tr>'+_0x2215e4(0x1a2)+String(_0x7b9744[_0x2215e4(0x184)])[_0x2215e4(0x1fc)](0x4,'0')+_0x2215e4(0x14e)+_0x2215e4(0x1a2)+fmtDate(_0x7b9744['dt'])+'</td>'+_0x2215e4(0x1a2)+_0x41e8b1+_0x2215e4(0x14e)+'<td>'+_0x7b9744[_0x2215e4(0x135)]+_0x2215e4(0x14e)+_0x2215e4(0x1a2)+fmtNum(_0x7b9744[_0x2215e4(0x1cb)])+_0x2215e4(0x14e)+'<td>'+(_0x7b9744[_0x2215e4(0x141)]||'')+_0x2215e4(0x14e)+_0x2215e4(0x1a2)+(_0x7b9744[_0x2215e4(0x16e)]||'')+_0x2215e4(0x14e)+'<td><div\x20class=\x22toolbar\x22><button\x20class=\x22btn\x22\x20data-print-slip=\x22'+_0x7b9744['id']+_0x2215e4(0x138)+_0x2215e4(0x15f);})[_0x379a15(0x167)]('');_0xffad8a[_0x379a15(0x163)]=_0x37bf07,$$(_0x379a15(0x208))[_0x379a15(0x189)](_0x49dbb7=>_0x49dbb7[_0x379a15(0x153)]=()=>{const _0x2eb94e=_0x379a15,_0x50c19e=db['slips'][_0x2eb94e(0x1db)](_0x4256d3=>_0x4256d3['id']===_0x49dbb7[_0x2eb94e(0x147)](_0x2eb94e(0x151)));if(_0x50c19e)openSlipPrint(_0x50c19e);}),applyResponsiveTableLabels(el(_0x379a15(0x1f0)));}function loadVehicleToForm(_0x56e53d){const _0x2f34c1=_0x1be814,_0x531193=db[_0x2f34c1(0x180)][_0x2f34c1(0x1db)](_0x1b0278=>_0x1b0278['id']===_0x56e53d);if(!_0x531193)return;el('vehFormTitle')[_0x2f34c1(0x201)]=_0x2f34c1(0x1f4)+_0x531193[_0x2f34c1(0x135)],el(_0x2f34c1(0x18c))[_0x2f34c1(0x1c7)]=_0x531193[_0x2f34c1(0x135)],el('vehBrand')[_0x2f34c1(0x1c7)]=_0x531193[_0x2f34c1(0x179)],el(_0x2f34c1(0x1d0))[_0x2f34c1(0x1c7)]=_0x531193[_0x2f34c1(0x200)],el(_0x2f34c1(0x1b3))[_0x2f34c1(0x1c7)]=_0x531193[_0x2f34c1(0x1e2)],el('vehTech')[_0x2f34c1(0x1c7)]=_0x531193[_0x2f34c1(0x139)],el(_0x2f34c1(0x160))['value']=_0x531193['odometer'],el(_0x2f34c1(0x1d8))[_0x2f34c1(0x186)][_0x2f34c1(0x214)]=_0x56e53d;}function _0x4d61(){const _0x2cc0cc=['btnLogout','Eliminar\x20vehículo\x20','trim','usrName','value','classList','</td><td>','some','kmOut','userSearch','#usrVehicles\x20option','justifyContent','odometer','vehModel','<button\x20class=\x22btn\x22\x20data-edit-user=\x22','click','driver','btnExportTrips','3098757iyUJZs','.sheet{max-width:800px;margin:0\x20auto;border:1px\x20solid\x20#d1d5db;padding:24px;border-radius:12px}','.responsive','btnVehSave','load','space-between','find','slipPurpose','href','El\x20km\x20de\x20salida\x20(','querySelectorAll','</b>\x20—\x20','viewDriver','soat','[data-edit-user]','tripVehiclePlate','No\x20puedes\x20borrar\x20al\x20admin','toUpperCase','indexOf','kmIn','2907NnzBhq','tbody\x20tr','</p>\x20\x20\x20\x20\x20\x20</div>\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x22>\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22section-title\x22><h2>Revisión\x20Técnica</h2></div>\x20\x20\x20\x20\x20\x20\x20\x20<p>Vence:\x20<b>','toISOString','Km\x20salida','btnAddUser','Completa\x20todos\x20los\x20campos','viewAdmin','createObjectURL','slipSearch','username','Editar\x20Vehículo\x20','slice','Los\x20kilómetros\x20no\x20pueden\x20ser\x20negativos','slips','btnUserClear','tripNotes','onchange','data-edit-user','padStart','Viaje\x20guardado','gridColumn','Obs.','model','textContent','driverVehicleSelect','[data-del-user]','admin123','name','vehicleInfo','body','[data-print-slip]','<button\x20class=\x22btn\x20danger\x22\x20data-del-user=\x22','thead\x20th','map','Km\x20de\x20salida\x20inválido','[data-del-veh]','driverId','querySelector','setItem','abs','button','setAttribute','editing','assign','from','16px','meta','162246soilRG','8078455IClxIT','key','vehicleSearch','flex','input','title','whoami','utf-8','\x20—\x20','loginUser','h1{font-size:20px;margin:0\x200\x208px}.muted{color:#6b7280}.grid{display:grid;grid-template-columns:1fr\x201fr;gap:12px}','Fecha','center','7281920lzboYP','box','v1.1.0','Usuario\x20o\x20contraseña\x20inválidos','<tr>','selected','div','usrVehicles','plate','Odómetro\x20actual:\x20','role','\x22>Imprimir</button></div></td>','tech','vehicleIds','El\x20km\x20de\x20llegada\x20debe\x20ser\x20mayor\x20o\x20igual\x20al\x20de\x20salida','replace','seed','trips','\x20km</td>','<br>','destination','2492760rOfWOs','randomUUID','.csv','filter','muted','getAttribute','addEventListener','btnRefreshDriver','Siguiente\x20N°:\x20','Crear\x20Vehículo','loginPass','</div></td>','</td>','<option\x20value=\x22','appendChild','data-print-slip','save','onclick','max','Eliminar\x20usuario\x20','btnLogin','btnSaveTrip','btnAddVehicle','\x22>Eliminar</button>','stringify','className','admin','sort','getElementById','</tr>','vehOdo','parse','charset','innerHTML','print','usrUsername','Generado\x20por\x20Control\x20Vehicular','join','<button\x20class=\x22btn\x20danger\x22\x20data-del-veh=\x22','style','text/csv;charset=utf-8;','_blank','Hyundai','XYZ-987','purpose','Destino','sheet','btnMakeSlip','add','</p>\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22muted\x22>Odómetro:\x20','slipsTable','Conductor','createElement','Hilux','reduce','brand','isArray','usrPassword','hidden','Recorrido','1\x20/\x20-1','\x22>Editar</button>','vehicles','usrRole','data-del-veh','Toyota','number','Firma\x20del\x20conductor','dataset','fleetData','</b></p>\x20\x20\x20\x20\x20\x20\x20\x20<p>','forEach','open','Placa','vehPlate','toLowerCase','Gary\x20Zarate','tripDateTime','now','vehTech','<td><div\x20class=\x22toolbar\x22>','password','users','vehFormTitle','user','<span\x20class=\x22badge\x20bad\x22>Vencido\x20(','btnAdminReload','close',')\x20debe\x20ser\x20≥\x20último\x20fin\x20(','\x20km</td><td>','push','Motivo','ABC-123','\x20km','appVersion','head','<td>','28GGFvjX','toggle','12HOoGAN','btnUserSave','slipNextLabel','Selecciona\x20un\x20vehículo','</p>\x20\x20\x20\x20\x20\x20</div>','Papeleta\x20','Vehículo\x20guardado','slipSeq','notes','tripHint','@media\x20print{body{margin:0}.sheet{border:0;border-radius:0;box-shadow:none}.no-print{display:none}}','Editar\x20Usuario\x20','16Txxshe','Vo.Bo.\x20(Administrador)','vehSoat','data-del-user','slipDest','viewLogin','54060wscKQU','userFormTitle','documentElement','vehBrand','\x20días)</span>','length','setHours','usersTable','Completa\x20usuario,\x20nombre\x20y\x20contraseña','getItem','82570VjpZsE','alignItems'];_0x4d61=function(){return _0x2cc0cc;};return _0x4d61();}function deleteVehicle(_0x57a0e6){const _0xc79b8e=_0x1be814,_0x44551f=db[_0xc79b8e(0x180)][_0xc79b8e(0x1db)](_0x478cbe=>_0x478cbe['id']===_0x57a0e6);if(!_0x44551f)return;if(!confirm(_0xc79b8e(0x1c4)+_0x44551f[_0xc79b8e(0x135)]+'?'))return;db[_0xc79b8e(0x194)][_0xc79b8e(0x189)](_0x5d855f=>_0x5d855f[_0xc79b8e(0x13a)]=(_0x5d855f[_0xc79b8e(0x13a)]||[])[_0xc79b8e(0x145)](_0x1aa6ad=>_0x1aa6ad!==_0x57a0e6)),db[_0xc79b8e(0x13e)]=db['trips'][_0xc79b8e(0x145)](_0x482813=>_0x482813[_0xc79b8e(0x135)]!==_0x44551f['plate']),db[_0xc79b8e(0x180)]=db[_0xc79b8e(0x180)][_0xc79b8e(0x145)](_0x3babf7=>_0x3babf7['id']!==_0x57a0e6),store[_0xc79b8e(0x152)](db),renderAdmin();}function fillUserVehicleOptions(){const _0x1f60f3=_0x1be814,_0x5e3630=el(_0x1f60f3(0x134));_0x5e3630['innerHTML']=db['vehicles'][_0x1f60f3(0x20b)](_0x568d8f=>_0x1f60f3(0x14f)+_0x568d8f['id']+'\x22>'+_0x568d8f[_0x1f60f3(0x135)]+_0x1f60f3(0x222)+_0x568d8f[_0x1f60f3(0x179)]+'\x20'+_0x568d8f[_0x1f60f3(0x200)]+'</option>')[_0x1f60f3(0x167)]('');}function loadUserToForm(_0x27a164){const _0x57fb91=_0x1be814,_0x5c5e40=db[_0x57fb91(0x194)][_0x57fb91(0x1db)](_0x44a6eb=>_0x44a6eb['id']===_0x27a164);if(!_0x5c5e40)return;el(_0x57fb91(0x1b8))[_0x57fb91(0x201)]=_0x57fb91(0x1b0)+_0x5c5e40[_0x57fb91(0x1f3)],el('usrUsername')[_0x57fb91(0x1c7)]=_0x5c5e40[_0x57fb91(0x1f3)],el(_0x57fb91(0x1c6))['value']=_0x5c5e40[_0x57fb91(0x205)],el(_0x57fb91(0x17b))[_0x57fb91(0x1c7)]=_0x5c5e40['password'],el(_0x57fb91(0x181))[_0x57fb91(0x1c7)]=_0x5c5e40[_0x57fb91(0x137)],fillUserVehicleOptions(),$$('#usrVehicles\x20option')[_0x57fb91(0x189)](_0x12c079=>_0x12c079[_0x57fb91(0x132)]=(_0x5c5e40[_0x57fb91(0x13a)]||[])[_0x57fb91(0x1e7)](_0x12c079[_0x57fb91(0x1c7)])!==-0x1),el(_0x57fb91(0x1a6))[_0x57fb91(0x186)][_0x57fb91(0x214)]=_0x27a164;}function deleteUser(_0x459adb){const _0x1d245b=_0x1be814,_0x2bac4c=db[_0x1d245b(0x194)][_0x1d245b(0x1db)](_0x278215=>_0x278215['id']===_0x459adb);if(!_0x2bac4c)return;if(_0x2bac4c[_0x1d245b(0x1f3)]===_0x1d245b(0x15c)){alert(_0x1d245b(0x1e5));return;}if(!confirm(_0x1d245b(0x155)+_0x2bac4c['username']+'?'))return;db[_0x1d245b(0x194)]=db[_0x1d245b(0x194)][_0x1d245b(0x145)](_0x33e03c=>_0x33e03c['id']!==_0x459adb),store['save'](db),renderAdmin();}el(_0x1be814(0x158))[_0x1be814(0x148)](_0x1be814(0x1d2),()=>{const _0x2687b9=_0x1be814;el(_0x2687b9(0x195))['textContent']=_0x2687b9(0x14b),[_0x2687b9(0x18c),'vehBrand',_0x2687b9(0x1d0),_0x2687b9(0x1b3),_0x2687b9(0x191),_0x2687b9(0x160)][_0x2687b9(0x189)](_0x2bf6d8=>el(_0x2bf6d8)[_0x2687b9(0x1c7)]=''),delete el('btnVehSave')['dataset'][_0x2687b9(0x214)];}),el('btnVehClear')[_0x1be814(0x148)](_0x1be814(0x1d2),()=>{const _0x22a727=_0x1be814;[_0x22a727(0x18c),_0x22a727(0x1ba),_0x22a727(0x1d0),_0x22a727(0x1b3),'vehTech','vehOdo'][_0x22a727(0x189)](_0x5eb0cf=>el(_0x5eb0cf)[_0x22a727(0x1c7)]=''),delete el(_0x22a727(0x1d8))[_0x22a727(0x186)][_0x22a727(0x214)];}),el('btnVehSave')[_0x1be814(0x148)](_0x1be814(0x1d2),()=>{const _0x2a0b8f=_0x1be814,_0x8d17ec={'plate':el(_0x2a0b8f(0x18c))[_0x2a0b8f(0x1c7)][_0x2a0b8f(0x1c5)]()[_0x2a0b8f(0x1e6)](),'brand':el(_0x2a0b8f(0x1ba))[_0x2a0b8f(0x1c7)][_0x2a0b8f(0x1c5)](),'model':el('vehModel')[_0x2a0b8f(0x1c7)][_0x2a0b8f(0x1c5)](),'soat':el('vehSoat')[_0x2a0b8f(0x1c7)],'tech':el(_0x2a0b8f(0x191))[_0x2a0b8f(0x1c7)],'odometer':Number(el(_0x2a0b8f(0x160))[_0x2a0b8f(0x1c7)]||0x0)};if(!_0x8d17ec[_0x2a0b8f(0x135)]||!_0x8d17ec[_0x2a0b8f(0x179)]||!_0x8d17ec[_0x2a0b8f(0x200)]||!_0x8d17ec[_0x2a0b8f(0x1e2)]||!_0x8d17ec['tech']){alert(_0x2a0b8f(0x1ef));return;}const _0x385866=el(_0x2a0b8f(0x1d8))[_0x2a0b8f(0x186)][_0x2a0b8f(0x214)];if(_0x385866){const _0x42cf06=db['vehicles']['find'](_0x22b46e=>_0x22b46e['id']===_0x385866);_0x42cf06[_0x2a0b8f(0x135)]!==_0x8d17ec['plate']&&(db[_0x2a0b8f(0x13e)][_0x2a0b8f(0x189)](_0x24d71a=>{const _0x3173ae=_0x2a0b8f;if(_0x24d71a[_0x3173ae(0x135)]===_0x42cf06[_0x3173ae(0x135)])_0x24d71a['plate']=_0x8d17ec[_0x3173ae(0x135)];}),db['slips']['forEach'](_0x2ac748=>{const _0x4e3d4c=_0x2a0b8f;if(_0x2ac748[_0x4e3d4c(0x135)]===_0x42cf06[_0x4e3d4c(0x135)])_0x2ac748['plate']=_0x8d17ec[_0x4e3d4c(0x135)];})),Object['assign'](_0x42cf06,_0x8d17ec);}else{if(db['vehicles']['some'](_0x5b5a0c=>_0x5b5a0c[_0x2a0b8f(0x135)]===_0x8d17ec[_0x2a0b8f(0x135)])){alert('Ya\x20existe\x20un\x20vehículo\x20con\x20esa\x20placa');return;}const _0x5ef23e=crypto[_0x2a0b8f(0x143)]?crypto['randomUUID']():String(Date[_0x2a0b8f(0x190)]());db[_0x2a0b8f(0x180)][_0x2a0b8f(0x19c)]({'id':'v'+_0x5ef23e,..._0x8d17ec});}store['save'](db),renderAdmin(),alert(_0x2a0b8f(0x1ab));}),el(_0x1be814(0x1ee))['addEventListener'](_0x1be814(0x1d2),()=>{const _0x48e61e=_0x1be814;el('userFormTitle')[_0x48e61e(0x201)]='Crear\x20Usuario',['usrUsername',_0x48e61e(0x1c6),_0x48e61e(0x17b)][_0x48e61e(0x189)](_0x5425c3=>el(_0x5425c3)[_0x48e61e(0x1c7)]=''),el(_0x48e61e(0x181))[_0x48e61e(0x1c7)]=_0x48e61e(0x1d3),fillUserVehicleOptions(),$$(_0x48e61e(0x1cd))['forEach'](_0x12435c=>_0x12435c[_0x48e61e(0x132)]=![]),delete el('btnUserSave')[_0x48e61e(0x186)]['editing'];}),el(_0x1be814(0x1f8))['addEventListener'](_0x1be814(0x1d2),()=>{const _0x510a68=_0x1be814;[_0x510a68(0x165),_0x510a68(0x1c6),_0x510a68(0x17b)][_0x510a68(0x189)](_0x49e077=>el(_0x49e077)[_0x510a68(0x1c7)]=''),el(_0x510a68(0x181))[_0x510a68(0x1c7)]=_0x510a68(0x1d3),$$('#usrVehicles\x20option')[_0x510a68(0x189)](_0x285549=>_0x285549['selected']=![]),delete el(_0x510a68(0x1a6))[_0x510a68(0x186)][_0x510a68(0x214)];}),el(_0x1be814(0x1a6))[_0x1be814(0x148)](_0x1be814(0x1d2),()=>{const _0x4b491c=_0x1be814,_0xc6dbe8=el(_0x4b491c(0x165))[_0x4b491c(0x1c7)]['trim'](),_0x395bf2=el(_0x4b491c(0x1c6))[_0x4b491c(0x1c7)]['trim'](),_0x4c337b=el(_0x4b491c(0x17b))[_0x4b491c(0x1c7)],_0x201852=el(_0x4b491c(0x181))['value'],_0x3437e4=$$('#usrVehicles\x20option')[_0x4b491c(0x145)](_0x12bc06=>_0x12bc06[_0x4b491c(0x132)])[_0x4b491c(0x20b)](_0x561951=>_0x561951[_0x4b491c(0x1c7)]);if(!_0xc6dbe8||!_0x395bf2||!_0x4c337b){alert(_0x4b491c(0x1bf));return;}const _0x5611fd=el(_0x4b491c(0x1a6))[_0x4b491c(0x186)][_0x4b491c(0x214)];if(_0x5611fd){const _0x452a16=db[_0x4b491c(0x194)][_0x4b491c(0x1db)](_0x46fba0=>_0x46fba0['id']===_0x5611fd);Object[_0x4b491c(0x215)](_0x452a16,{'username':_0xc6dbe8,'name':_0x395bf2,'password':_0x4c337b,'role':_0x201852,'vehicleIds':_0x3437e4});}else{if(db[_0x4b491c(0x194)][_0x4b491c(0x1ca)](_0x2d98aa=>_0x2d98aa['username']===_0xc6dbe8)){alert('Ya\x20existe\x20ese\x20usuario');return;}const _0x24ab9b=crypto['randomUUID']?crypto['randomUUID']():String(Date[_0x4b491c(0x190)]());db[_0x4b491c(0x194)][_0x4b491c(0x19c)]({'id':'u'+_0x24ab9b,'username':_0xc6dbe8,'name':_0x395bf2,'password':_0x4c337b,'role':_0x201852,'vehicleIds':_0x3437e4});}store[_0x4b491c(0x152)](db),renderAdmin(),alert('Usuario\x20guardado');}),el(_0x1be814(0x1a0))[_0x1be814(0x201)]=VERSION,show(_0x1be814(0x1b6)),refreshWho();if(el(_0x1be814(0x1f2)))el(_0x1be814(0x1f2))[_0x1be814(0x148)](_0x1be814(0x21e),renderSlipsTable);el(_0x1be814(0x21c))[_0x1be814(0x148)](_0x1be814(0x21e),renderVehiclesTable),el(_0x1be814(0x1cc))[_0x1be814(0x148)]('input',renderUsersTable),el(_0x1be814(0x198))[_0x1be814(0x148)](_0x1be814(0x1d2),renderAdmin);
  </script>
</body>
</html>
